'use strict';

var assign = require('object-assign');
var validate = require('../validators');

function DatasetsClient(client) {
  this.request = client.request.bind(client);
}

assign(DatasetsClient.prototype, {
  create: function create(name) {
    return this._modify('PUT', name);
  },
  delete: function _delete(name) {
    return this._modify('DELETE', name);
  },
  list: function list() {
    return this.request({ uri: '/datasets' });
  },
  _modify: function _modify(method, name) {
    validate.dataset(name);
    return this.request({ method: method, uri: '/datasets/' + name });
  }
});

module.exports = DatasetsClient;