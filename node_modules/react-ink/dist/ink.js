module.exports=function(t){function e(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=6)}([function(t,e,o){function n(t){return l(t.duration,Date.now()-t.mouseDown)}function r(t){return t.mouseUp>0?Date.now()-t.mouseUp:0}function i(t){var e=t.duration,o=t.radius,i=.85*a(n(t),0,o,e),u=.15*a(r(t),0,o,e),l=.02*o*s(Date.now()/e);return c(0,i+u+l)}var a=o(7),u=Math.sqrt(2),s=Math.cos,c=Math.max,l=Math.min;t.exports={getMaxRadius:function(t,e,o){return l(.5*c(t,e),o)},getBlotOpacity:function(t,e){return a(r(t),e,-e,t.duration)},getBlotOuterOpacity:function(t,e){return l(this.getBlotOpacity(t,e),a(n(t),0,.3,3*t.duration))},getBlotShiftX:function(t,e,o){return l(1,i(t)/e*2/u)*(o/2-t.x)},getBlotShiftY:function(t,e,o){return l(1,i(t)/e*2/u)*(o/2-t.y)},getBlotScale:function(t){return i(t)/t.radius}}},function(t,e){t.exports={borderRadius:"inherit",height:"100%",left:0,position:"absolute",top:0,width:"100%"}},function(t,e){var o=!1;"undefined"!=typeof window&&(o="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),t.exports=o},function(t,e){t.exports=function(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}},function(t,e,o){var n=o(0),r=function(t){var e=t.mouseUp,o=t.duration;return!e||Date.now()-e<o};t.exports=function(t){var e=[],o=!1,i=void 0,a={each:function(t,o){for(var n=0,r=e.length;n<r;n++)t.call(o,e[n])},play:function(){o||(o=!0,a.update())},stop:function(){o=!1,cancelAnimationFrame(i)},getTotalOpacity:function(t){for(var o=0,r=0,i=e.length;r<i;r++)o+=n.getBlotOuterOpacity(e[r],t);return o},update:function(){e=e.filter(r),e.length?i=requestAnimationFrame(a.update):a.stop(),t()},add:function(t){e.push(t),a.play()},release:function(t){for(var o=e.length-1;o>=0;o--)if(!e[o].mouseUp)return e[o].mouseUp=t}};return a}},function(t,e){t.exports=require("react")},function(t,e,o){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},u=o(2),s=0,c=o(3),l=o(5),p=o(1),f=o(4),h=2*Math.PI,d=o(0),g=function(t){function e(o){n(this,e);var i=r(this,t.apply(this,arguments));return i.tick=function(){var t=i.state,e=t.ctx,o=t.color,n=t.density,r=t.height,a=t.width,u=t.store;e.save(),e.scale(n,n),e.clearRect(0,0,a,r),e.fillStyle=o,i.props.background&&(e.globalAlpha=u.getTotalOpacity(i.props.opacity),e.fillRect(0,0,a,r)),u.each(i.makeBlot,i),e.restore()},i._onPress=function(t){var e=t.button,o=t.ctrlKey,n=t.clientX,r=t.clientY,a=t.changedTouches,u=Date.now();if(a)for(var c=0;c<a.length;c++){var l=a[c],p=l.clientX,f=l.clientY;i.pushBlot(u,p,f)}else e!==s||o||i.pushBlot(u,n,r)},i._onRelease=function(){i.state.store.release(Date.now())},i.state={color:"transparent",density:1,height:0,store:f(i.tick),touchEvents:i.touchEvents(),width:0},i}return i(e,t),e.prototype.touchEvents=function(){return this.props.hasTouch?{onTouchStart:this._onPress,onTouchEnd:this._onRelease,onTouchCancel:this._onRelease}:{onMouseDown:this._onPress,onMouseUp:this._onRelease,onMouseLeave:this._onRelease}},e.prototype.makeBlot=function(t){var e=this.state,o=e.ctx,n=e.height,r=e.width,i=t.x,a=t.y,u=t.radius;if(o.globalAlpha=d.getBlotOpacity(t,this.props.opacity),o.beginPath(),this.props.recenter){var s=Math.max(n,r);i+=d.getBlotShiftX(t,s,r),a+=d.getBlotShiftY(t,s,n)}o.arc(i,a,u*d.getBlotScale(t),0,h),o.closePath(),o.fill()},e.prototype.componentWillUnmount=function(){this.state.store.stop()},e.prototype.pushBlot=function(t,e,o){var n=this,r=this.refs.canvas;r instanceof window.HTMLCanvasElement==!1&&(r=r.getDOMNode());var i=r.getBoundingClientRect(),a=i.top,u=i.bottom,s=i.left,l=i.right,p=window.getComputedStyle(r),f=p.color,h=this.state.ctx||r.getContext("2d"),g=c(h),y=u-a,v=l-s,w=d.getMaxRadius(y,v,this.props.radius);this.setState({color:f,ctx:h,density:g,height:y,width:v},function(){n.state.store.add({duration:n.props.duration,mouseDown:t,mouseUp:0,radius:w,x:e-s,y:o-a})})},e.prototype.render=function(){var t=this.state,e=t.density,o=t.height,n=t.width,r=t.touchEvents;return l.createElement("canvas",a({className:"ink",ref:"canvas",style:a({},p,this.props.style),height:o*e,width:n*e,onDragOver:this._onRelease},r))},e}(l.PureComponent);g.defaultProps={background:!0,duration:1e3,opacity:.25,radius:150,recenter:!0,hasTouch:u},t.exports=g},function(t,e){t.exports=function(t,e,o,n){return o*((t=t/n-1)*t*t*t*t+1)+e}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5rLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA0YmZmMDVlNWU3N2Q4NDU5Nzc1OSIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9lcXVhdGlvbnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0eWxlLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlsL2hhc1RvdWNoLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlsL3BpeGVsUmF0aW8uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvc3RvcmUuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwicmVhY3RcIiIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvZWFzaW5nLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImkiLCJsIiwiY2FsbCIsIm0iLCJjIiwidmFsdWUiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImdldFByZXNzIiwiYmxvdCIsIm1pbiIsImR1cmF0aW9uIiwiRGF0ZSIsIm5vdyIsIm1vdXNlRG93biIsImdldFJlbGVhc2UiLCJtb3VzZVVwIiwiZ2V0UmFkaXVzIiwicmFkaXVzIiwiZG93biIsImVhc2luZyIsInVwIiwidW5kdWxhdGlvbiIsImNvcyIsIm1heCIsIlNRUlRfMiIsIk1hdGgiLCJzcXJ0IiwiZ2V0TWF4UmFkaXVzIiwiaGVpZ2h0Iiwid2lkdGgiLCJnZXRCbG90T3BhY2l0eSIsIm9wYWNpdHkiLCJnZXRCbG90T3V0ZXJPcGFjaXR5IiwidGhpcyIsImdldEJsb3RTaGlmdFgiLCJzaXplIiwieCIsImdldEJsb3RTaGlmdFkiLCJ5IiwiZ2V0QmxvdFNjYWxlIiwiYm9yZGVyUmFkaXVzIiwibGVmdCIsInBvc2l0aW9uIiwidG9wIiwiYm9vbCIsIndpbmRvdyIsIkRvY3VtZW50VG91Y2giLCJkb2N1bWVudCIsImNvbnRleHQiLCJkZXZpY2VQaXhlbFJhdGlvIiwid2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyIsIm1vekJhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJtc0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJvQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyIsImJhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJFcXVhdGlvbnMiLCJraWxsU3RhbGUiLCJfcmVmIiwicHVibGljaXplIiwiX2RhdGEiLCJfcGxheWluZyIsIl9mcmFtZSIsIlN0b3JlIiwiZWFjaCIsImNhbGxiYWNrIiwic2NvcGUiLCJsZW5ndGgiLCJwbGF5IiwidXBkYXRlIiwic3RvcCIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwiZ2V0VG90YWxPcGFjaXR5IiwiYW5zd2VyIiwiZmlsdGVyIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYWRkIiwicHJvcHMiLCJwdXNoIiwicmVsZWFzZSIsInRpbWUiLCJyZXF1aXJlIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwic2VsZiIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ3cml0YWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiX2V4dGVuZHMiLCJhc3NpZ24iLCJ0YXJnZXQiLCJhcmd1bWVudHMiLCJzb3VyY2UiLCJrZXkiLCJIQVNfVE9VQ0giLCJNT1VTRV9MRUZUIiwicGl4ZWxSYXRpbyIsIlJlYWN0IiwiU1RZTEUiLCJUQVUiLCJQSSIsIkluayIsIl9SZWFjdCRQdXJlQ29tcG9uZW50IiwiX3RoaXMiLCJhcHBseSIsInRpY2siLCJfdGhpcyRzdGF0ZSIsInN0YXRlIiwiY3R4IiwiY29sb3IiLCJkZW5zaXR5Iiwic3RvcmUiLCJzYXZlIiwic2NhbGUiLCJjbGVhclJlY3QiLCJmaWxsU3R5bGUiLCJiYWNrZ3JvdW5kIiwiZ2xvYmFsQWxwaGEiLCJmaWxsUmVjdCIsIm1ha2VCbG90IiwicmVzdG9yZSIsIl9vblByZXNzIiwiZSIsImJ1dHRvbiIsImN0cmxLZXkiLCJjbGllbnRYIiwiY2xpZW50WSIsImNoYW5nZWRUb3VjaGVzIiwidGltZVN0YW1wIiwiX2NoYW5nZWRUb3VjaGVzJGkiLCJwdXNoQmxvdCIsIl9vblJlbGVhc2UiLCJ0b3VjaEV2ZW50cyIsImhhc1RvdWNoIiwib25Ub3VjaFN0YXJ0Iiwib25Ub3VjaEVuZCIsIm9uVG91Y2hDYW5jZWwiLCJvbk1vdXNlRG93biIsIm9uTW91c2VVcCIsIm9uTW91c2VMZWF2ZSIsIl9zdGF0ZSIsImJlZ2luUGF0aCIsInJlY2VudGVyIiwiYXJjIiwiY2xvc2VQYXRoIiwiZmlsbCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwiX3RoaXMyIiwiZWwiLCJyZWZzIiwiY2FudmFzIiwiSFRNTENhbnZhc0VsZW1lbnQiLCJnZXRET01Ob2RlIiwiX2VsJGdldEJvdW5kaW5nQ2xpZW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiYm90dG9tIiwicmlnaHQiLCJfd2luZG93JGdldENvbXB1dGVkU3QiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0Q29udGV4dCIsInNldFN0YXRlIiwicmVuZGVyIiwiX3N0YXRlMiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJyZWYiLCJzdHlsZSIsIm9uRHJhZ092ZXIiLCJQdXJlQ29tcG9uZW50IiwiZGVmYXVsdFByb3BzIiwidCIsImIiXSwibWFwcGluZ3MiOiJBQUFBQSxPQUFPQyxRQUNFLFNBQVVDLEdDR25CLFFBQUFDLEdBQUFDLEdBR0EsR0FB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VVF2U0pzSyxPUnVTdUIsV1F2U2IsR0FBQUMsR0FDc0N6SSxLQUFLa0YsTUFBN0NHLEVBREVvRCxFQUNGcEQsUUFBUzFGLEVBRFA4SSxFQUNPOUksT0FBUUMsRUFEZjZJLEVBQ2U3SSxNQUFPK0csRUFEdEI4QixFQUNzQjlCLFdBRTlCLE9BQ0VuQyxHQUFBa0UsY0FBQSxTQUFBM0UsR0FBUTRFLFVBQVUsTUFDVkMsSUFBSSxTQUNKQyxNQUFBOUUsS0FBWVUsRUFBVXpFLEtBQUsyQyxNQUFNa0csT0FDakNsSixPQUFTQSxFQUFTMEYsRUFDbEJ6RixNQUFRQSxFQUFReUYsRUFDaEJ5RCxXQUFhOUksS0FBSzBHLFlBQ2JDLEtSOFNWL0IsR1ExYVNKLEVBQU11RSxjQUFsQm5FLEdBRUdvRSxjQUNMckQsWUFBYSxFQUNibEgsU0FBYSxJQUNicUIsUUFBYSxJQUNiZCxPQUFhLElBQ2JxSSxVQUFhLEVBQ2JULFNBQWF2QyxHQTRJakI1SCxFQUFPQyxRQUFVa0ksR1J1U1gsU0FBVW5JLEVBQVFDLEdTbmN4QkQsRUFBT0MsUUFBVSxTQUF1QnVNLEVBQUdDLEVBQUcvTCxFQUFHRSxHQUMvQyxNQUFPRixLQUFJOEwsRUFBRUEsRUFBRTVMLEVBQUUsR0FBRzRMLEVBQUVBLEVBQUVBLEVBQUVBLEVBQUksR0FBS0MiLCJmaWxlIjoiaW5rLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPVxuLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDYpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG52YXIgZWFzaW5nID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcbnZhciBTUVJUXzIgPSBNYXRoLnNxcnQoMik7XG52YXIgY29zID0gTWF0aC5jb3MsXG4gICAgbWF4ID0gTWF0aC5tYXgsXG4gICAgbWluID0gTWF0aC5taW47XG5cblxuZnVuY3Rpb24gZ2V0UHJlc3MoYmxvdCkge1xuICByZXR1cm4gbWluKGJsb3QuZHVyYXRpb24sIERhdGUubm93KCkgLSBibG90Lm1vdXNlRG93bik7XG59XG5cbmZ1bmN0aW9uIGdldFJlbGVhc2UoYmxvdCkge1xuICByZXR1cm4gYmxvdC5tb3VzZVVwID4gMCA/IERhdGUubm93KCkgLSBibG90Lm1vdXNlVXAgOiAwO1xufVxuXG5mdW5jdGlvbiBnZXRSYWRpdXMoYmxvdCkge1xuICB2YXIgZHVyYXRpb24gPSBibG90LmR1cmF0aW9uLFxuICAgICAgcmFkaXVzID0gYmxvdC5yYWRpdXM7XG5cblxuICB2YXIgZG93biA9IGVhc2luZyhnZXRQcmVzcyhibG90KSwgMCwgcmFkaXVzLCBkdXJhdGlvbikgKiAwLjg1O1xuICB2YXIgdXAgPSBlYXNpbmcoZ2V0UmVsZWFzZShibG90KSwgMCwgcmFkaXVzLCBkdXJhdGlvbikgKiAwLjE1O1xuICB2YXIgdW5kdWxhdGlvbiA9IHJhZGl1cyAqIDAuMDIgKiBjb3MoRGF0ZS5ub3coKSAvIGR1cmF0aW9uKTtcblxuICByZXR1cm4gbWF4KDAsIGRvd24gKyB1cCArIHVuZHVsYXRpb24pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZ2V0TWF4UmFkaXVzOiBmdW5jdGlvbiBnZXRNYXhSYWRpdXMoaGVpZ2h0LCB3aWR0aCwgcmFkaXVzKSB7XG4gICAgcmV0dXJuIG1pbihtYXgoaGVpZ2h0LCB3aWR0aCkgKiAwLjUsIHJhZGl1cyk7XG4gIH0sXG4gIGdldEJsb3RPcGFjaXR5OiBmdW5jdGlvbiBnZXRCbG90T3BhY2l0eShibG90LCBvcGFjaXR5KSB7XG4gICAgcmV0dXJuIGVhc2luZyhnZXRSZWxlYXNlKGJsb3QpLCBvcGFjaXR5LCAtb3BhY2l0eSwgYmxvdC5kdXJhdGlvbik7XG4gIH0sXG4gIGdldEJsb3RPdXRlck9wYWNpdHk6IGZ1bmN0aW9uIGdldEJsb3RPdXRlck9wYWNpdHkoYmxvdCwgb3BhY2l0eSkge1xuICAgIHJldHVybiBtaW4odGhpcy5nZXRCbG90T3BhY2l0eShibG90LCBvcGFjaXR5KSwgZWFzaW5nKGdldFByZXNzKGJsb3QpLCAwLCAwLjMsIGJsb3QuZHVyYXRpb24gKiAzKSk7XG4gIH0sXG4gIGdldEJsb3RTaGlmdFg6IGZ1bmN0aW9uIGdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpIHtcbiAgICByZXR1cm4gbWluKDEsIGdldFJhZGl1cyhibG90KSAvIHNpemUgKiAyIC8gU1FSVF8yKSAqICh3aWR0aCAvIDIgLSBibG90LngpO1xuICB9LFxuICBnZXRCbG90U2hpZnRZOiBmdW5jdGlvbiBnZXRCbG90U2hpZnRZKGJsb3QsIHNpemUsIGhlaWdodCkge1xuICAgIHJldHVybiBtaW4oMSwgZ2V0UmFkaXVzKGJsb3QpIC8gc2l6ZSAqIDIgLyBTUVJUXzIpICogKGhlaWdodCAvIDIgLSBibG90LnkpO1xuICB9LFxuICBnZXRCbG90U2NhbGU6IGZ1bmN0aW9uIGdldEJsb3RTY2FsZShibG90KSB7XG4gICAgcmV0dXJuIGdldFJhZGl1cyhibG90KSAvIGJsb3QucmFkaXVzO1xuICB9XG59O1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGJvcmRlclJhZGl1czogJ2luaGVyaXQnLFxuICBoZWlnaHQ6ICcxMDAlJyxcbiAgbGVmdDogMCxcbiAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gIHRvcDogMCxcbiAgd2lkdGg6ICcxMDAlJ1xufTtcblxuLyoqKi8gfSksXG4vKiAyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbnZhciBib29sID0gZmFsc2U7XG5cbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICBib29sID0gJ29udG91Y2hzdGFydCcgaW4gd2luZG93IHx8IHdpbmRvdy5Eb2N1bWVudFRvdWNoICYmIGRvY3VtZW50IGluc3RhbmNlb2Ygd2luZG93LkRvY3VtZW50VG91Y2g7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYm9vbDtcblxuLyoqKi8gfSksXG4vKiAzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbi8vIEdvb2Qgc3R1ZmYgaGVyZTpcbi8vIGh0dHA6Ly93d3cuaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL2NhbnZhcy9oaWRwaS9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRldmljZVBpeGVsUmF0aW8gPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJhY2tpbmdTdG9yZVJhdGlvID0gY29udGV4dC53ZWJraXRCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGNvbnRleHQubW96QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCBjb250ZXh0Lm1zQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCBjb250ZXh0Lm9CYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGNvbnRleHQuYmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCAxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGV2aWNlUGl4ZWxSYXRpbyAvIGJhY2tpbmdTdG9yZVJhdGlvO1xufTtcblxuLyoqKi8gfSksXG4vKiA0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbi8qKlxuICogSW5rIFN0b3JlXG4gKiBLZWVwcyB0cmFjayBvZiBjaGFuZ2VzIHRvIHJpcHBsZSBlcGljZW50ZXJzXG4gKiBzbyB0aGF0IDxJbmsgLz4gY2FuIGZvY3VzIG9uIHJlbmRlcmluZyB0aGVtLlxuICovXG5cbnZhciBFcXVhdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIga2lsbFN0YWxlID0gZnVuY3Rpb24ga2lsbFN0YWxlKF9yZWYpIHtcbiAgdmFyIG1vdXNlVXAgPSBfcmVmLm1vdXNlVXAsXG4gICAgICBkdXJhdGlvbiA9IF9yZWYuZHVyYXRpb247XG4gIHJldHVybiAhbW91c2VVcCB8fCBEYXRlLm5vdygpIC0gbW91c2VVcCA8IGR1cmF0aW9uO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAocHVibGljaXplKSB7XG4gIHZhciBfZGF0YSA9IFtdO1xuICB2YXIgX3BsYXlpbmcgPSBmYWxzZTtcbiAgdmFyIF9mcmFtZSA9IHZvaWQgMDtcblxuICB2YXIgU3RvcmUgPSB7XG4gICAgZWFjaDogZnVuY3Rpb24gZWFjaChjYWxsYmFjaywgc2NvcGUpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gX2RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwoc2NvcGUsIF9kYXRhW2ldKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHBsYXk6IGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgICBpZiAoIV9wbGF5aW5nKSB7XG4gICAgICAgIF9wbGF5aW5nID0gdHJ1ZTtcbiAgICAgICAgU3RvcmUudXBkYXRlKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBzdG9wOiBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgX3BsYXlpbmcgPSBmYWxzZTtcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKF9mcmFtZSk7XG4gICAgfSxcbiAgICBnZXRUb3RhbE9wYWNpdHk6IGZ1bmN0aW9uIGdldFRvdGFsT3BhY2l0eShvcGFjaXR5KSB7XG4gICAgICB2YXIgYW5zd2VyID0gMDtcblxuICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBfZGF0YS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgYW5zd2VyICs9IEVxdWF0aW9ucy5nZXRCbG90T3V0ZXJPcGFjaXR5KF9kYXRhW2ldLCBvcGFjaXR5KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFuc3dlcjtcbiAgICB9LFxuICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKCkge1xuICAgICAgX2RhdGEgPSBfZGF0YS5maWx0ZXIoa2lsbFN0YWxlKTtcblxuICAgICAgaWYgKF9kYXRhLmxlbmd0aCkge1xuICAgICAgICBfZnJhbWUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoU3RvcmUudXBkYXRlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFN0b3JlLnN0b3AoKTtcbiAgICAgIH1cblxuICAgICAgcHVibGljaXplKCk7XG4gICAgfSxcbiAgICBhZGQ6IGZ1bmN0aW9uIGFkZChwcm9wcykge1xuICAgICAgX2RhdGEucHVzaChwcm9wcyk7XG4gICAgICBTdG9yZS5wbGF5KCk7XG4gICAgfSxcbiAgICByZWxlYXNlOiBmdW5jdGlvbiByZWxlYXNlKHRpbWUpIHtcbiAgICAgIGZvciAodmFyIGkgPSBfZGF0YS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICBpZiAoIV9kYXRhW2ldLm1vdXNlVXApIHtcbiAgICAgICAgICByZXR1cm4gX2RhdGFbaV0ubW91c2VVcCA9IHRpbWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIFN0b3JlO1xufTtcblxuLyoqKi8gfSksXG4vKiA1ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInJlYWN0XCIpO1xuXG4vKioqLyB9KSxcbi8qIDYgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxudmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIElua1xuICogRmlsbHMgYSBjb250YWluZXIgd2l0aCBhbiBTVkcgb2JqZWN0IHRoYXQgcHJvdmlkZXMgZmVlZGJhY2sgb24gbW91c2UvdG91Y2hcbiAqIGV2ZW50cyB3aXRoIGEgcmlwcGxpbmcgcG9vbC5cbiAqL1xuXG52YXIgSEFTX1RPVUNIID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcbnZhciBNT1VTRV9MRUZUID0gMDtcbnZhciBwaXhlbFJhdGlvID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcbnZhciBSZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG52YXIgU1RZTEUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xudmFyIFN0b3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcbnZhciBUQVUgPSBNYXRoLlBJICogMjtcbnZhciBFcXVhdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIgSW5rID0gZnVuY3Rpb24gKF9SZWFjdCRQdXJlQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhJbmssIF9SZWFjdCRQdXJlQ29tcG9uZW50KTtcblxuICBmdW5jdGlvbiBJbmsocHJvcHMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW5rKTtcblxuICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9SZWFjdCRQdXJlQ29tcG9uZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuXG4gICAgX3RoaXMudGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfdGhpcyRzdGF0ZSA9IF90aGlzLnN0YXRlLFxuICAgICAgICAgIGN0eCA9IF90aGlzJHN0YXRlLmN0eCxcbiAgICAgICAgICBjb2xvciA9IF90aGlzJHN0YXRlLmNvbG9yLFxuICAgICAgICAgIGRlbnNpdHkgPSBfdGhpcyRzdGF0ZS5kZW5zaXR5LFxuICAgICAgICAgIGhlaWdodCA9IF90aGlzJHN0YXRlLmhlaWdodCxcbiAgICAgICAgICB3aWR0aCA9IF90aGlzJHN0YXRlLndpZHRoLFxuICAgICAgICAgIHN0b3JlID0gX3RoaXMkc3RhdGUuc3RvcmU7XG5cblxuICAgICAgY3R4LnNhdmUoKTtcblxuICAgICAgY3R4LnNjYWxlKGRlbnNpdHksIGRlbnNpdHkpO1xuXG4gICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICBjdHguZmlsbFN0eWxlID0gY29sb3I7XG5cbiAgICAgIGlmIChfdGhpcy5wcm9wcy5iYWNrZ3JvdW5kKSB7XG4gICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IHN0b3JlLmdldFRvdGFsT3BhY2l0eShfdGhpcy5wcm9wcy5vcGFjaXR5KTtcbiAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgfVxuXG4gICAgICBzdG9yZS5lYWNoKF90aGlzLm1ha2VCbG90LCBfdGhpcyk7XG5cbiAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgfTtcblxuICAgIF90aGlzLl9vblByZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciBidXR0b24gPSBlLmJ1dHRvbixcbiAgICAgICAgICBjdHJsS2V5ID0gZS5jdHJsS2V5LFxuICAgICAgICAgIGNsaWVudFggPSBlLmNsaWVudFgsXG4gICAgICAgICAgY2xpZW50WSA9IGUuY2xpZW50WSxcbiAgICAgICAgICBjaGFuZ2VkVG91Y2hlcyA9IGUuY2hhbmdlZFRvdWNoZXM7XG5cbiAgICAgIHZhciB0aW1lU3RhbXAgPSBEYXRlLm5vdygpO1xuXG4gICAgICBpZiAoY2hhbmdlZFRvdWNoZXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFuZ2VkVG91Y2hlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBfY2hhbmdlZFRvdWNoZXMkaSA9IGNoYW5nZWRUb3VjaGVzW2ldLFxuICAgICAgICAgICAgICBfY2xpZW50WCA9IF9jaGFuZ2VkVG91Y2hlcyRpLmNsaWVudFgsXG4gICAgICAgICAgICAgIF9jbGllbnRZID0gX2NoYW5nZWRUb3VjaGVzJGkuY2xpZW50WTtcblxuICAgICAgICAgIF90aGlzLnB1c2hCbG90KHRpbWVTdGFtcCwgX2NsaWVudFgsIF9jbGllbnRZKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChidXR0b24gPT09IE1PVVNFX0xFRlQgJiYgIWN0cmxLZXkpIHtcbiAgICAgICAgX3RoaXMucHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMuX29uUmVsZWFzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzLnN0YXRlLnN0b3JlLnJlbGVhc2UoRGF0ZS5ub3coKSk7XG4gICAgfTtcblxuICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAgY29sb3I6ICd0cmFuc3BhcmVudCcsXG4gICAgICBkZW5zaXR5OiAxLFxuICAgICAgaGVpZ2h0OiAwLFxuICAgICAgc3RvcmU6IFN0b3JlKF90aGlzLnRpY2spLFxuICAgICAgdG91Y2hFdmVudHM6IF90aGlzLnRvdWNoRXZlbnRzKCksXG4gICAgICB3aWR0aDogMFxuICAgIH07XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgSW5rLnByb3RvdHlwZS50b3VjaEV2ZW50cyA9IGZ1bmN0aW9uIHRvdWNoRXZlbnRzKCkge1xuICAgIGlmICh0aGlzLnByb3BzLmhhc1RvdWNoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBvblRvdWNoU3RhcnQ6IHRoaXMuX29uUHJlc3MsXG4gICAgICAgIG9uVG91Y2hFbmQ6IHRoaXMuX29uUmVsZWFzZSxcbiAgICAgICAgb25Ub3VjaENhbmNlbDogdGhpcy5fb25SZWxlYXNlXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBvbk1vdXNlRG93bjogdGhpcy5fb25QcmVzcyxcbiAgICAgICAgb25Nb3VzZVVwOiB0aGlzLl9vblJlbGVhc2UsXG4gICAgICAgIG9uTW91c2VMZWF2ZTogdGhpcy5fb25SZWxlYXNlXG4gICAgICB9O1xuICAgIH1cbiAgfTtcblxuICBJbmsucHJvdG90eXBlLm1ha2VCbG90ID0gZnVuY3Rpb24gbWFrZUJsb3QoYmxvdCkge1xuICAgIHZhciBfc3RhdGUgPSB0aGlzLnN0YXRlLFxuICAgICAgICBjdHggPSBfc3RhdGUuY3R4LFxuICAgICAgICBoZWlnaHQgPSBfc3RhdGUuaGVpZ2h0LFxuICAgICAgICB3aWR0aCA9IF9zdGF0ZS53aWR0aDtcbiAgICB2YXIgeCA9IGJsb3QueCxcbiAgICAgICAgeSA9IGJsb3QueSxcbiAgICAgICAgcmFkaXVzID0gYmxvdC5yYWRpdXM7XG5cblxuICAgIGN0eC5nbG9iYWxBbHBoYSA9IEVxdWF0aW9ucy5nZXRCbG90T3BhY2l0eShibG90LCB0aGlzLnByb3BzLm9wYWNpdHkpO1xuICAgIGN0eC5iZWdpblBhdGgoKTtcblxuICAgIGlmICh0aGlzLnByb3BzLnJlY2VudGVyKSB7XG4gICAgICB2YXIgc2l6ZSA9IE1hdGgubWF4KGhlaWdodCwgd2lkdGgpO1xuXG4gICAgICB4ICs9IEVxdWF0aW9ucy5nZXRCbG90U2hpZnRYKGJsb3QsIHNpemUsIHdpZHRoKTtcbiAgICAgIHkgKz0gRXF1YXRpb25zLmdldEJsb3RTaGlmdFkoYmxvdCwgc2l6ZSwgaGVpZ2h0KTtcbiAgICB9XG5cbiAgICBjdHguYXJjKHgsIHksIHJhZGl1cyAqIEVxdWF0aW9ucy5nZXRCbG90U2NhbGUoYmxvdCksIDAsIFRBVSk7XG5cbiAgICBjdHguY2xvc2VQYXRoKCk7XG4gICAgY3R4LmZpbGwoKTtcbiAgfTtcblxuICBJbmsucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5zdGF0ZS5zdG9yZS5zdG9wKCk7XG4gIH07XG5cbiAgSW5rLnByb3RvdHlwZS5wdXNoQmxvdCA9IGZ1bmN0aW9uIHB1c2hCbG90KHRpbWVTdGFtcCwgY2xpZW50WCwgY2xpZW50WSkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgdmFyIGVsID0gdGhpcy5yZWZzLmNhbnZhcztcblxuICAgIC8vIDAuMTMgc3VwcG9ydFxuICAgIGlmIChlbCBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MQ2FudmFzRWxlbWVudCA9PT0gZmFsc2UpIHtcbiAgICAgIGVsID0gZWwuZ2V0RE9NTm9kZSgpO1xuICAgIH1cblxuICAgIHZhciBfZWwkZ2V0Qm91bmRpbmdDbGllbnQgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgdG9wID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50LnRvcCxcbiAgICAgICAgYm90dG9tID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50LmJvdHRvbSxcbiAgICAgICAgbGVmdCA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudC5sZWZ0LFxuICAgICAgICByaWdodCA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudC5yaWdodDtcblxuICAgIHZhciBfd2luZG93JGdldENvbXB1dGVkU3QgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbCksXG4gICAgICAgIGNvbG9yID0gX3dpbmRvdyRnZXRDb21wdXRlZFN0LmNvbG9yO1xuXG4gICAgdmFyIGN0eCA9IHRoaXMuc3RhdGUuY3R4IHx8IGVsLmdldENvbnRleHQoJzJkJyk7XG4gICAgdmFyIGRlbnNpdHkgPSBwaXhlbFJhdGlvKGN0eCk7XG4gICAgdmFyIGhlaWdodCA9IGJvdHRvbSAtIHRvcDtcbiAgICB2YXIgd2lkdGggPSByaWdodCAtIGxlZnQ7XG4gICAgdmFyIHJhZGl1cyA9IEVxdWF0aW9ucy5nZXRNYXhSYWRpdXMoaGVpZ2h0LCB3aWR0aCwgdGhpcy5wcm9wcy5yYWRpdXMpO1xuXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGNvbG9yOiBjb2xvciwgY3R4OiBjdHgsIGRlbnNpdHk6IGRlbnNpdHksIGhlaWdodDogaGVpZ2h0LCB3aWR0aDogd2lkdGggfSwgZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMyLnN0YXRlLnN0b3JlLmFkZCh7XG4gICAgICAgIGR1cmF0aW9uOiBfdGhpczIucHJvcHMuZHVyYXRpb24sXG4gICAgICAgIG1vdXNlRG93bjogdGltZVN0YW1wLFxuICAgICAgICBtb3VzZVVwOiAwLFxuICAgICAgICByYWRpdXM6IHJhZGl1cyxcbiAgICAgICAgeDogY2xpZW50WCAtIGxlZnQsXG4gICAgICAgIHk6IGNsaWVudFkgLSB0b3BcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIEluay5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgIHZhciBfc3RhdGUyID0gdGhpcy5zdGF0ZSxcbiAgICAgICAgZGVuc2l0eSA9IF9zdGF0ZTIuZGVuc2l0eSxcbiAgICAgICAgaGVpZ2h0ID0gX3N0YXRlMi5oZWlnaHQsXG4gICAgICAgIHdpZHRoID0gX3N0YXRlMi53aWR0aCxcbiAgICAgICAgdG91Y2hFdmVudHMgPSBfc3RhdGUyLnRvdWNoRXZlbnRzO1xuXG5cbiAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgnY2FudmFzJywgX2V4dGVuZHMoeyBjbGFzc05hbWU6ICdpbmsnLFxuICAgICAgcmVmOiAnY2FudmFzJyxcbiAgICAgIHN0eWxlOiBfZXh0ZW5kcyh7fSwgU1RZTEUsIHRoaXMucHJvcHMuc3R5bGUpLFxuICAgICAgaGVpZ2h0OiBoZWlnaHQgKiBkZW5zaXR5LFxuICAgICAgd2lkdGg6IHdpZHRoICogZGVuc2l0eSxcbiAgICAgIG9uRHJhZ092ZXI6IHRoaXMuX29uUmVsZWFzZVxuICAgIH0sIHRvdWNoRXZlbnRzKSk7XG4gIH07XG5cbiAgcmV0dXJuIEluaztcbn0oUmVhY3QuUHVyZUNvbXBvbmVudCk7XG5cbkluay5kZWZhdWx0UHJvcHMgPSB7XG4gIGJhY2tncm91bmQ6IHRydWUsXG4gIGR1cmF0aW9uOiAxMDAwLFxuICBvcGFjaXR5OiAwLjI1LFxuICByYWRpdXM6IDE1MCxcbiAgcmVjZW50ZXI6IHRydWUsXG4gIGhhc1RvdWNoOiBIQVNfVE9VQ0hcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBJbms7XG5cbi8qKiovIH0pLFxuLyogNyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG4vKipcbiAqIEB0IGlzIHRoZSBjdXJyZW50IHRpbWUgKG9yIHBvc2l0aW9uKSBvZiB0aGUgdHdlZW4uIFRoaXMgY2FuIGJlIHNlY29uZHMgb3IgZnJhbWVzLCBzdGVwcywgc2Vjb25kcywgbXMsIHdoYXRldmVyIOKAkyBhcyBsb25nIGFzIHRoZSB1bml0IGlzIHRoZSBzYW1lIGFzIGlzIHVzZWQgZm9yIHRoZSB0b3RhbCB0aW1lIFszXS5cbiAqIEBiIGlzIHRoZSBiZWdpbm5pbmcgdmFsdWUgb2YgdGhlIHByb3BlcnR5LlxuICogQGMgaXMgdGhlIGNoYW5nZSBiZXR3ZWVuIHRoZSBiZWdpbm5pbmcgYW5kIGRlc3RpbmF0aW9uIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eS5cbiAqIEBkIGlzIHRoZSB0b3RhbCB0aW1lIG9mIHRoZSB0d2Vlbi5cbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGVhc2VPdXRRdWludCh0LCBiLCBjLCBkKSB7XG4gIHJldHVybiBjICogKCh0ID0gdCAvIGQgLSAxKSAqIHQgKiB0ICogdCAqIHQgKyAxKSArIGI7XG59O1xuXG4vKioqLyB9KVxuLyoqKioqKi8gXSk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGluay5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDYpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDRiZmYwNWU1ZTc3ZDg0NTk3NzU5IiwibGV0IGVhc2luZyA9IHJlcXVpcmUoJy4vZWFzaW5nJylcbmxldCBTUVJUXzIgPSBNYXRoLnNxcnQoMilcbmxldCB7IGNvcywgbWF4LCBtaW4gfSA9IE1hdGhcblxuZnVuY3Rpb24gZ2V0UHJlc3MoYmxvdCkge1xuICByZXR1cm4gbWluKGJsb3QuZHVyYXRpb24sIERhdGUubm93KCkgLSBibG90Lm1vdXNlRG93bilcbn1cblxuZnVuY3Rpb24gZ2V0UmVsZWFzZShibG90KSB7XG4gIHJldHVybiBibG90Lm1vdXNlVXAgPiAwID8gRGF0ZS5ub3coKSAtIGJsb3QubW91c2VVcCA6IDBcbn1cblxuZnVuY3Rpb24gZ2V0UmFkaXVzKGJsb3QpIHtcbiAgbGV0IHsgZHVyYXRpb24sIHJhZGl1cyB9ID0gYmxvdFxuXG4gIGxldCBkb3duICAgICAgID0gZWFzaW5nKGdldFByZXNzKGJsb3QpLCAwLCByYWRpdXMsIGR1cmF0aW9uKSAqIDAuODVcbiAgbGV0IHVwICAgICAgICAgPSBlYXNpbmcoZ2V0UmVsZWFzZShibG90KSwgMCwgcmFkaXVzLCBkdXJhdGlvbikgKiAwLjE1XG4gIGxldCB1bmR1bGF0aW9uID0gcmFkaXVzICogMC4wMiAqIGNvcyhEYXRlLm5vdygpIC8gZHVyYXRpb24pXG5cbiAgcmV0dXJuIG1heCgwLCBkb3duICsgdXAgKyB1bmR1bGF0aW9uKVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICBnZXRNYXhSYWRpdXMoaGVpZ2h0LCB3aWR0aCwgcmFkaXVzKSB7XG4gICAgcmV0dXJuIG1pbihtYXgoaGVpZ2h0LCB3aWR0aCkgKiAwLjUsIHJhZGl1cylcbiAgfSxcblxuICBnZXRCbG90T3BhY2l0eShibG90LCBvcGFjaXR5KSB7XG4gICAgcmV0dXJuIGVhc2luZyhnZXRSZWxlYXNlKGJsb3QpLCBvcGFjaXR5LCAtb3BhY2l0eSwgYmxvdC5kdXJhdGlvbilcbiAgfSxcblxuICBnZXRCbG90T3V0ZXJPcGFjaXR5KGJsb3QsIG9wYWNpdHkpIHtcbiAgICByZXR1cm4gbWluKHRoaXMuZ2V0QmxvdE9wYWNpdHkoYmxvdCwgb3BhY2l0eSksXG4gICAgICAgICAgICAgICBlYXNpbmcoZ2V0UHJlc3MoYmxvdCksIDAsIDAuMywgYmxvdC5kdXJhdGlvbiAqIDMpKVxuICB9LFxuXG4gIGdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpIHtcbiAgICByZXR1cm4gbWluKDEsXG4gICAgICAgICAgICAgICBnZXRSYWRpdXMoYmxvdCkgLyBzaXplICogMiAvIFNRUlRfMikgKiAod2lkdGggLyAyIC0gYmxvdC54KVxuICB9LFxuXG4gIGdldEJsb3RTaGlmdFkoYmxvdCwgc2l6ZSwgaGVpZ2h0KSB7XG4gICAgcmV0dXJuIG1pbigxLFxuICAgICAgICAgICAgICAgZ2V0UmFkaXVzKGJsb3QpIC8gc2l6ZSAqIDIgLyBTUVJUXzIpICogKGhlaWdodCAvIDIgLSBibG90LnkpXG4gIH0sXG5cbiAgZ2V0QmxvdFNjYWxlKGJsb3QpIHtcbiAgICByZXR1cm4gZ2V0UmFkaXVzKGJsb3QpIC8gYmxvdC5yYWRpdXNcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvZXF1YXRpb25zLmpzIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIGJvcmRlclJhZGl1czogJ2luaGVyaXQnLFxuICBoZWlnaHQ6ICcxMDAlJyxcbiAgbGVmdDogMCxcbiAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gIHRvcDogMCxcbiAgd2lkdGg6ICcxMDAlJ1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3N0eWxlLmpzIiwidmFyIGJvb2wgPSBmYWxzZVxuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgYm9vbCA9ICgnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cpIHx8IHdpbmRvdy5Eb2N1bWVudFRvdWNoICYmIGRvY3VtZW50IGluc3RhbmNlb2Ygd2luZG93LkRvY3VtZW50VG91Y2hcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBib29sXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbC9oYXNUb3VjaC5qcyIsIi8vIEdvb2Qgc3R1ZmYgaGVyZTpcbi8vIGh0dHA6Ly93d3cuaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL2NhbnZhcy9oaWRwaS9cblxubW9kdWxlLmV4cG9ydHMgPSBjb250ZXh0ID0+IHtcbiAgbGV0IGRldmljZVBpeGVsUmF0aW8gID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMVxuICBsZXQgYmFja2luZ1N0b3JlUmF0aW8gPSBjb250ZXh0LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0Lm9CYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICAgIHx8IDFcblxuICByZXR1cm4gZGV2aWNlUGl4ZWxSYXRpbyAvIGJhY2tpbmdTdG9yZVJhdGlvXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbC9waXhlbFJhdGlvLmpzIiwiLyoqXG4gKiBJbmsgU3RvcmVcbiAqIEtlZXBzIHRyYWNrIG9mIGNoYW5nZXMgdG8gcmlwcGxlIGVwaWNlbnRlcnNcbiAqIHNvIHRoYXQgPEluayAvPiBjYW4gZm9jdXMgb24gcmVuZGVyaW5nIHRoZW0uXG4gKi9cblxudmFyIEVxdWF0aW9ucyA9IHJlcXVpcmUoJy4vZXF1YXRpb25zJylcblxubGV0IGtpbGxTdGFsZSA9ICh7IG1vdXNlVXAsIGR1cmF0aW9uIH0pID0+ICFtb3VzZVVwIHx8IChEYXRlLm5vdygpIC0gbW91c2VVcCkgPCBkdXJhdGlvblxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHB1YmxpY2l6ZSkge1xuICBsZXQgX2RhdGEgICAgPSBbXVxuICBsZXQgX3BsYXlpbmcgPSBmYWxzZVxuICBsZXQgX2ZyYW1lXG5cbiAgbGV0IFN0b3JlID0ge1xuXG4gICAgZWFjaChjYWxsYmFjaywgc2NvcGUpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gX2RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwoc2NvcGUsIF9kYXRhW2ldKVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBwbGF5KCkge1xuICAgICAgaWYgKCFfcGxheWluZykge1xuICAgICAgICBfcGxheWluZyA9IHRydWVcbiAgICAgICAgU3RvcmUudXBkYXRlKClcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc3RvcCgpIHtcbiAgICAgIF9wbGF5aW5nID0gZmFsc2VcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKF9mcmFtZSlcbiAgICB9LFxuXG4gICAgZ2V0VG90YWxPcGFjaXR5KG9wYWNpdHkpIHtcbiAgICAgIGxldCBhbnN3ZXIgPSAwXG5cbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gX2RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGFuc3dlciArPSBFcXVhdGlvbnMuZ2V0QmxvdE91dGVyT3BhY2l0eShfZGF0YVtpXSwgb3BhY2l0eSlcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFuc3dlclxuICAgIH0sXG5cbiAgICB1cGRhdGUoKSB7XG4gICAgICBfZGF0YSA9IF9kYXRhLmZpbHRlcihraWxsU3RhbGUpXG5cbiAgICAgIGlmIChfZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgX2ZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKFN0b3JlLnVwZGF0ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFN0b3JlLnN0b3AoKVxuICAgICAgfVxuXG4gICAgICBwdWJsaWNpemUoKVxuICAgIH0sXG5cbiAgICBhZGQocHJvcHMpIHtcbiAgICAgIF9kYXRhLnB1c2gocHJvcHMpXG4gICAgICBTdG9yZS5wbGF5KClcbiAgICB9LFxuXG4gICAgcmVsZWFzZSh0aW1lKSB7XG4gICAgICBmb3IgKGxldCBpID0gX2RhdGEubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgaWYgKCFfZGF0YVtpXS5tb3VzZVVwKSB7XG4gICAgICAgICAgcmV0dXJuIF9kYXRhW2ldLm1vdXNlVXAgPSB0aW1lXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuXG4gIHJldHVybiBTdG9yZVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvc3RvcmUuanMiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWFjdFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInJlYWN0XCJcbi8vIG1vZHVsZSBpZCA9IDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBJbmtcbiAqIEZpbGxzIGEgY29udGFpbmVyIHdpdGggYW4gU1ZHIG9iamVjdCB0aGF0IHByb3ZpZGVzIGZlZWRiYWNrIG9uIG1vdXNlL3RvdWNoXG4gKiBldmVudHMgd2l0aCBhIHJpcHBsaW5nIHBvb2wuXG4gKi9cblxubGV0IEhBU19UT1VDSCAgPSByZXF1aXJlKCcuL3V0aWwvaGFzVG91Y2gnKVxubGV0IE1PVVNFX0xFRlQgPSAwXG5sZXQgcGl4ZWxSYXRpbyA9IHJlcXVpcmUoJy4vdXRpbC9waXhlbFJhdGlvJylcbmxldCBSZWFjdCAgICAgID0gcmVxdWlyZSgncmVhY3QnKVxubGV0IFNUWUxFICAgICAgPSByZXF1aXJlKCcuL3N0eWxlJylcbmxldCBTdG9yZSAgICAgID0gcmVxdWlyZSgnLi91dGlsL3N0b3JlJylcbmxldCBUQVUgICAgICAgID0gTWF0aC5QSSAqIDJcbmxldCBFcXVhdGlvbnMgID0gcmVxdWlyZSgnLi91dGlsL2VxdWF0aW9ucycpXG5cbmNsYXNzIEluayBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQge1xuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgYmFja2dyb3VuZCA6IHRydWUsXG4gICAgZHVyYXRpb24gICA6IDEwMDAsXG4gICAgb3BhY2l0eSAgICA6IDAuMjUsXG4gICAgcmFkaXVzICAgICA6IDE1MCxcbiAgICByZWNlbnRlciAgIDogdHJ1ZSxcbiAgICBoYXNUb3VjaCAgIDogSEFTX1RPVUNIXG4gIH1cblxuICBjb25zdHJ1Y3RvciAocHJvcHMpIHtcbiAgICBzdXBlciguLi5hcmd1bWVudHMpXG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgY29sb3IgICAgICAgOiAndHJhbnNwYXJlbnQnLFxuICAgICAgZGVuc2l0eSAgICAgOiAxLFxuICAgICAgaGVpZ2h0ICAgICAgOiAwLFxuICAgICAgc3RvcmUgICAgICAgOiBTdG9yZSh0aGlzLnRpY2spLFxuICAgICAgdG91Y2hFdmVudHMgOiB0aGlzLnRvdWNoRXZlbnRzKCksXG4gICAgICB3aWR0aCAgICAgICA6IDBcbiAgICB9XG4gIH1cblxuICB0b3VjaEV2ZW50cyAoKSB7XG4gICAgaWYgKHRoaXMucHJvcHMuaGFzVG91Y2gpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9uVG91Y2hTdGFydCAgOiB0aGlzLl9vblByZXNzLFxuICAgICAgICBvblRvdWNoRW5kICAgIDogdGhpcy5fb25SZWxlYXNlLFxuICAgICAgICBvblRvdWNoQ2FuY2VsIDogdGhpcy5fb25SZWxlYXNlXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9uTW91c2VEb3duICAgOiB0aGlzLl9vblByZXNzLFxuICAgICAgICBvbk1vdXNlVXAgICAgIDogdGhpcy5fb25SZWxlYXNlLFxuICAgICAgICBvbk1vdXNlTGVhdmUgIDogdGhpcy5fb25SZWxlYXNlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdGljayA9ICgpID0+IHtcbiAgICBsZXQgeyBjdHgsIGNvbG9yLCBkZW5zaXR5LCBoZWlnaHQsIHdpZHRoLCBzdG9yZSB9ID0gdGhpcy5zdGF0ZVxuXG4gICAgY3R4LnNhdmUoKVxuXG4gICAgY3R4LnNjYWxlKGRlbnNpdHksIGRlbnNpdHkpXG5cbiAgICBjdHguY2xlYXJSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpXG5cbiAgICBjdHguZmlsbFN0eWxlID0gY29sb3JcblxuICAgIGlmICh0aGlzLnByb3BzLmJhY2tncm91bmQpIHtcbiAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IHN0b3JlLmdldFRvdGFsT3BhY2l0eSh0aGlzLnByb3BzLm9wYWNpdHkpXG4gICAgICBjdHguZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodClcbiAgICB9XG5cbiAgICBzdG9yZS5lYWNoKHRoaXMubWFrZUJsb3QsIHRoaXMpXG5cbiAgICBjdHgucmVzdG9yZSgpXG4gIH1cblxuICBtYWtlQmxvdCAoYmxvdCkge1xuICAgIGxldCB7IGN0eCwgaGVpZ2h0LCB3aWR0aCB9ID0gdGhpcy5zdGF0ZVxuICAgIGxldCB7IHgsIHksIHJhZGl1cyB9ID0gYmxvdFxuXG4gICAgY3R4Lmdsb2JhbEFscGhhID0gRXF1YXRpb25zLmdldEJsb3RPcGFjaXR5KGJsb3QsIHRoaXMucHJvcHMub3BhY2l0eSlcbiAgICBjdHguYmVnaW5QYXRoKClcblxuICAgIGlmICh0aGlzLnByb3BzLnJlY2VudGVyKSB7XG4gICAgICBsZXQgc2l6ZSA9IE1hdGgubWF4KGhlaWdodCwgd2lkdGgpXG5cbiAgICAgIHggKz0gRXF1YXRpb25zLmdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpXG4gICAgICB5ICs9IEVxdWF0aW9ucy5nZXRCbG90U2hpZnRZKGJsb3QsIHNpemUsIGhlaWdodClcbiAgICB9XG5cbiAgICBjdHguYXJjKHgsIHksIHJhZGl1cyAqIEVxdWF0aW9ucy5nZXRCbG90U2NhbGUoYmxvdCksIDAsIFRBVSlcblxuICAgIGN0eC5jbG9zZVBhdGgoKVxuICAgIGN0eC5maWxsKClcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50ICgpIHtcbiAgICB0aGlzLnN0YXRlLnN0b3JlLnN0b3AoKVxuICB9XG5cbiAgcHVzaEJsb3QgKHRpbWVTdGFtcCwgY2xpZW50WCwgY2xpZW50WSkge1xuICAgIGxldCBlbCA9IHRoaXMucmVmcy5jYW52YXNcblxuICAgIC8vIDAuMTMgc3VwcG9ydFxuICAgIGlmIChlbCBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MQ2FudmFzRWxlbWVudCA9PT0gZmFsc2UpIHtcbiAgICAgIGVsID0gZWwuZ2V0RE9NTm9kZSgpXG4gICAgfVxuXG4gICAgbGV0IHsgdG9wLCBib3R0b20sIGxlZnQsIHJpZ2h0IH0gPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgIGxldCB7IGNvbG9yIH0gPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbClcblxuICAgIGxldCBjdHggICAgID0gdGhpcy5zdGF0ZS5jdHggfHwgZWwuZ2V0Q29udGV4dCgnMmQnKVxuICAgIGxldCBkZW5zaXR5ID0gcGl4ZWxSYXRpbyhjdHgpXG4gICAgbGV0IGhlaWdodCAgPSBib3R0b20gLSB0b3BcbiAgICBsZXQgd2lkdGggICA9IHJpZ2h0IC0gbGVmdFxuICAgIGxldCByYWRpdXMgID0gRXF1YXRpb25zLmdldE1heFJhZGl1cyhoZWlnaHQsIHdpZHRoLCB0aGlzLnByb3BzLnJhZGl1cylcblxuICAgIHRoaXMuc2V0U3RhdGUoeyBjb2xvciwgY3R4LCBkZW5zaXR5LCBoZWlnaHQsIHdpZHRoIH0sICgpID0+IHtcbiAgICAgIHRoaXMuc3RhdGUuc3RvcmUuYWRkKHtcbiAgICAgICAgZHVyYXRpb24gIDogdGhpcy5wcm9wcy5kdXJhdGlvbixcbiAgICAgICAgbW91c2VEb3duIDogdGltZVN0YW1wLFxuICAgICAgICBtb3VzZVVwICAgOiAwLFxuICAgICAgICByYWRpdXMgICAgOiByYWRpdXMsXG4gICAgICAgIHggICAgICAgICA6IGNsaWVudFggLSBsZWZ0LFxuICAgICAgICB5ICAgICAgICAgOiBjbGllbnRZIC0gdG9wXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICByZW5kZXIgKCkge1xuICAgIGxldCB7IGRlbnNpdHksIGhlaWdodCwgd2lkdGgsIHRvdWNoRXZlbnRzIH0gPSB0aGlzLnN0YXRlXG5cbiAgICByZXR1cm4gKFxuICAgICAgPGNhbnZhcyBjbGFzc05hbWU9XCJpbmtcIlxuICAgICAgICAgICAgICByZWY9XCJjYW52YXNcIlxuICAgICAgICAgICAgICBzdHlsZT17eyAuLi5TVFlMRSwgLi4udGhpcy5wcm9wcy5zdHlsZSB9fVxuICAgICAgICAgICAgICBoZWlnaHQ9eyBoZWlnaHQgKiBkZW5zaXR5IH1cbiAgICAgICAgICAgICAgd2lkdGg9eyB3aWR0aCAqIGRlbnNpdHkgfVxuICAgICAgICAgICAgICBvbkRyYWdPdmVyPXsgdGhpcy5fb25SZWxlYXNlIH1cbiAgICAgICAgICAgICAgeyAuLi50b3VjaEV2ZW50cyB9IC8+XG4gICAgKVxuICB9XG5cbiAgX29uUHJlc3MgPSAoZSkgPT4ge1xuICAgIGxldCB7IGJ1dHRvbiwgY3RybEtleSwgY2xpZW50WCwgY2xpZW50WSwgY2hhbmdlZFRvdWNoZXMgfSA9IGVcbiAgICBsZXQgdGltZVN0YW1wID0gRGF0ZS5ub3coKVxuXG4gICAgaWYgKGNoYW5nZWRUb3VjaGVzKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYW5nZWRUb3VjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCB7IGNsaWVudFgsIGNsaWVudFkgfSA9IGNoYW5nZWRUb3VjaGVzW2ldXG4gICAgICAgIHRoaXMucHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoYnV0dG9uID09PSBNT1VTRV9MRUZUICYmICFjdHJsS2V5KSB7XG4gICAgICB0aGlzLnB1c2hCbG90KHRpbWVTdGFtcCwgY2xpZW50WCwgY2xpZW50WSlcbiAgICB9XG4gIH1cblxuICBfb25SZWxlYXNlID0gKCkgPT4ge1xuICAgIHRoaXMuc3RhdGUuc3RvcmUucmVsZWFzZShEYXRlLm5vdygpKVxuICB9XG5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBJbmtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC5qcyIsIi8qKlxuICogQHQgaXMgdGhlIGN1cnJlbnQgdGltZSAob3IgcG9zaXRpb24pIG9mIHRoZSB0d2Vlbi4gVGhpcyBjYW4gYmUgc2Vjb25kcyBvciBmcmFtZXMsIHN0ZXBzLCBzZWNvbmRzLCBtcywgd2hhdGV2ZXIg4oCTIGFzIGxvbmcgYXMgdGhlIHVuaXQgaXMgdGhlIHNhbWUgYXMgaXMgdXNlZCBmb3IgdGhlIHRvdGFsIHRpbWUgWzNdLlxuICogQGIgaXMgdGhlIGJlZ2lubmluZyB2YWx1ZSBvZiB0aGUgcHJvcGVydHkuXG4gKiBAYyBpcyB0aGUgY2hhbmdlIGJldHdlZW4gdGhlIGJlZ2lubmluZyBhbmQgZGVzdGluYXRpb24gdmFsdWUgb2YgdGhlIHByb3BlcnR5LlxuICogQGQgaXMgdGhlIHRvdGFsIHRpbWUgb2YgdGhlIHR3ZWVuLlxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZWFzZU91dFF1aW50ICh0LCBiLCBjLCBkKSB7XG4gIHJldHVybiBjKigodD10L2QtMSkqdCp0KnQqdCArIDEpICsgYlxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvZWFzaW5nLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==